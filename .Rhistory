geom_errorbar(aes(y = outcome, ymin = outcome - ci, ymax = outcome + ci),
color = "black", width = 0.05) +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=50, alpha=.1, fill="blue") +
facet_wrap(~incomegroup_name) +
theme_minimal() +
labs(title="Share of commitments delivered through non-State channels\nBy recipient income group",
subtitle="Level: donor-recipient dyad. Grouped by recipients' income groups",
y="%",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
data_dyad |>
filter(incomegroup_name=="MADCTs") |>
distinct(recipient_name)
data_crs |>
filter(incomegroup_name=="MADCTs") |>
distinct(recipient_name)
measure.prop_summarySEwithin_and_plot("commit.channel_nonstate_ngo") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=25, alpha=.1, fill="blue") +
labs(title="Share of commitments delivered through NGOs",
subtitle="Level: donor-recipient dyad",
y="%",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
measure.prop_summarySEwithin_and_plot("commit.channel_nonstate_ngo") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=15, alpha=.1, fill="blue") +
labs(title="Share of commitments delivered through NGOs",
subtitle="Level: donor-recipient dyad",
y="%",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
measure.prop_summarySEwithin_and_plot("commit.channel_nonstate_multi") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=15, alpha=.1, fill="blue") +
labs(title="Share of commitments delivered through Multilaterals",
subtitle="Level: donor-recipient dyad",
y="%",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
measure.prop_summarySEwithin_and_plot("commit.channel_nonstate_multi") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=12, alpha=.1, fill="blue") +
labs(title="Share of commitments delivered through Multilaterals",
subtitle="Level: donor-recipient dyad",
y="%",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_projects") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=2.5, alpha=.1, fill="blue") +
labs(title="Number of projects",
subtitle="Level: donor-recipient dyad",
y="# projects",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_project") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=2.5, alpha=.1, fill="blue") +
labs(title="Number of projects",
subtitle="Level: donor-recipient dyad",
y="# projects",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_project") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=30, alpha=.1, fill="blue") +
labs(title="Number of projects",
subtitle="Level: donor-recipient dyad",
y="# projects",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("size_project") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=30, alpha=.1, fill="blue") +
labs(title="Average size of projects",
subtitle="Level: donor-recipient dyad",
y="Millions, USD",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("size_project") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=10, alpha=.1, fill="blue") +
labs(title="Average size of projects",
subtitle="Level: donor-recipient dyad",
y="Millions, USD",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("size_project") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=5.5, alpha=.1, fill="blue") +
labs(title="Average size of projects",
subtitle="Level: donor-recipient dyad",
y="Millions, USD",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("size_project") + 6, alpha=.1, fill="blue") +
summarySEwithin_and_plot("size_project") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=6, alpha=.1, fill="blue") +
labs(title="Average size of projects",
subtitle="Level: donor-recipient dyad",
y="Millions, USD",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_sector") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=6, alpha=.1, fill="blue") +
labs(title="Average number of sectors",
subtitle="Level: donor-recipient dyad",
y="# sectors",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_sector") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=7, alpha=.1, fill="blue") +
labs(title="Average number of sectors",
subtitle="Level: donor-recipient dyad",
y="# sectors",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_sector") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=7, alpha=.1, fill="blue") +
labs(title="Average number of sectors w/ positive commitments",
subtitle="Level: donor-recipient dyad",
y="# sectors",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_sector") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=7, alpha=.1, fill="blue") +
labs(title="Average number of sub-sectors",
subtitle="Level: donor-recipient dyad",
y="# sub-sectors (purposes)",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_purpose") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=7, alpha=.1, fill="blue") +
labs(title="Average number of sub-sectors",
subtitle="Level: donor-recipient dyad",
y="# sub-sectors (purposes)",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_purpose") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=11, alpha=.1, fill="blue") +
labs(title="Average number of sub-sectors",
subtitle="Level: donor-recipient dyad",
y="# sub-sectors (purposes)",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_purpose") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=12, alpha=.1, fill="blue") +
labs(title="Average number of sub-sectors",
subtitle="Level: donor-recipient dyad",
y="# sub-sectors (purposes)",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_purpose") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=11, alpha=.1, fill="blue") +
labs(title="Average number of sub-sectors",
subtitle="Level: donor-recipient dyad",
y="# sub-sectors (purposes)",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
summarySEwithin_and_plot("n_purpose") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=11, alpha=.1, fill="blue") +
labs(title="Average number of sub-sectors ('purposes') w/ positive commitments",
subtitle="Level: donor-recipient dyad",
y="# sub-sectors (purposes)",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
# select vars
between_periods_comparison <- copy(data_dyad)
between_periods_comparison <- between_periods_comparison[, .(donor_id, donor_name,
recipient_id, recipient_name,
year,
outcome = commitment,
treatment)
# create new variable `period` where treatment year = 0
][, period := year - year[treatment==1], by = .(donor_id, recipient_id)]
# add donor type variable
facet_donor <- left_join(between_periods_comparison,
data_crs |>
distinct(donor_id, bi_multi) |>
filter(!(donor_id %in% c("0003", "0075") & bi_multi=="Private Sector")),
by = "donor_id"
) |>
relocate(bi_multi, .after = donor_name)
data <- facet_donor |>
fmutate(
group = paste(donor_id, recipient_id, sep = "_"),
period = factor(period),
outcome = outcome
) |>
filter(period %in% c(-3:3)) |>
filter(!length(group) < 7, .by = group)
## Level trend
dat_summary <- Rmisc::summarySEwithin(data,
measurevar = "outcome",
withinvars = "period",
idvar = "group",
na.rm = TRUE)
ggplot(dat_summary, aes(x = period, y = outcome)) +
geom_point(color = "black") +
geom_errorbar(aes(y = outcome, ymin = outcome - ci, ymax = outcome + ci),
color = "black", width = 0.05) +
facet_wrap(~bi_multi) +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=55, alpha=.1, fill="blue") +
theme_minimal()
# select vars
between_periods_comparison <- copy(data_dyad)
between_periods_comparison <- between_periods_comparison[, .(donor_id, donor_name,
recipient_id, recipient_name,
year,
outcome = commitment,
treatment)
# create new variable `period` where treatment year = 0
][, period := year - year[treatment==1], by = .(donor_id, recipient_id)]
# add donor type variable
facet_donor <- left_join(between_periods_comparison,
data_crs |>
distinct(donor_id, bi_multi) |>
filter(!(donor_id %in% c("0003", "0075") & bi_multi=="Private Sector")),
by = "donor_id"
) |>
relocate(bi_multi, .after = donor_name)
data <- facet_donor |>
fmutate(
group = paste(donor_id, recipient_id, sep = "_"),
period = factor(period),
outcome = outcome
) |>
filter(period %in% c(-3:3)) |>
filter(!length(group) < 7, .by = group)
## Level trend
dat_summary <- Rmisc::summarySEwithin(data,
measurevar = "outcome",
withinvars = c("bi_multi", "period"),
idvar = "group",
na.rm = TRUE)
ggplot(dat_summary, aes(x = period, y = outcome)) +
geom_point(color = "black") +
geom_errorbar(aes(y = outcome, ymin = outcome - ci, ymax = outcome + ci),
color = "black", width = 0.05) +
facet_wrap(~bi_multi) +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=55, alpha=.1, fill="blue") +
theme_minimal()
# select vars
between_periods_comparison <- copy(data_dyad)
between_periods_comparison <- between_periods_comparison[, .(donor_id, donor_name,
recipient_id, recipient_name,
year,
outcome = commitment,
treatment)
# create new variable `period` where treatment year = 0
][, period := year - year[treatment==1], by = .(donor_id, recipient_id)]
# add donor type variable
facet_donor <- left_join(between_periods_comparison,
data_crs |>
distinct(donor_id, bi_multi) |>
filter(!(donor_id %in% c("0003", "0075") & bi_multi=="Private Sector")),
by = "donor_id"
) |>
relocate(bi_multi, .after = donor_name)
data <- facet_donor |>
fmutate(
group = paste(donor_id, recipient_id, sep = "_"),
period = factor(period),
outcome = outcome
) |>
filter(period %in% c(-3:3)) |>
filter(!length(group) < 7, .by = group)
## Level trend
dat_summary <- Rmisc::summarySEwithin(data,
measurevar = "outcome",
withinvars = c("bi_multi", "period"),
idvar = "group",
na.rm = TRUE)
ggplot(dat_summary, aes(x = period, y = outcome)) +
geom_point(color = "black") +
geom_errorbar(aes(y = outcome, ymin = outcome - ci, ymax = outcome + ci),
color = "black", width = 0.05) +
facet_wrap(~bi_multi) +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=40, alpha=.1, fill="blue") +
theme_minimal()
# select vars
between_periods_comparison <- copy(data_dyad)
between_periods_comparison <- between_periods_comparison[, .(donor_id, donor_name,
recipient_id, recipient_name,
year,
outcome = commitment,
treatment)
# create new variable `period` where treatment year = 0
][, period := year - year[treatment==1], by = .(donor_id, recipient_id)]
# add donor type variable
facet_donor <- left_join(between_periods_comparison,
data_crs |>
distinct(donor_id, bi_multi) |>
filter(!(donor_id %in% c("0003", "0075") & bi_multi=="Private Sector")),
by = "donor_id"
) |>
relocate(bi_multi, .after = donor_name)
data <- facet_donor |>
fmutate(
group = paste(donor_id, recipient_id, sep = "_"),
period = factor(period),
outcome = outcome
) |>
filter(period %in% c(-3:3)) |>
filter(!length(group) < 7, .by = group)
## Level trend
dat_summary <- Rmisc::summarySEwithin(data,
measurevar = "outcome",
withinvars = c("bi_multi", "period"),
idvar = "group",
na.rm = TRUE)
ggplot(dat_summary, aes(x = period, y = outcome)) +
geom_point(color = "black") +
geom_errorbar(aes(y = outcome, ymin = outcome - ci, ymax = outcome + ci),
color = "black", width = 0.05) +
facet_wrap(~bi_multi) +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=40, alpha=.1, fill="blue") +
theme_minimal() +
labs(title="Total commitments\nBy donor type",
subtitle="Level: donor-recipient dyad",
y="Millions, USD",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
# select vars
between_periods_comparison <- copy(data_dyad)
between_periods_comparison <- between_periods_comparison[, .(donor_id, donor_name,
recipient_id, recipient_name,
year,
outcome = commitment,
treatment)
# create new variable `period` where treatment year = 0
][, period := year - year[treatment==1], by = .(donor_id, recipient_id)]
# add recipient income group variable
facet_recip <- left_join(between_periods_comparison,
data_crs |> distinct(recipient_id, incomegroup_name),
by = "recipient_id") |>
relocate(incomegroup_name, .after = recipient_name)
data <- facet_recip |>
fmutate(
group = paste(donor_id, recipient_id, sep = "_"),
period = factor(period),
outcome = outcome
) |>
filter(period %in% c(-3:3)) |>
filter(!length(group) < 7, .by = group)
## Level trend
dat_summary <- Rmisc::summarySEwithin(data,
measurevar = "outcome",
withinvars = c("bi_multi", "period"),
idvar = "group",
na.rm = TRUE)
# select vars
between_periods_comparison <- copy(data_dyad)
between_periods_comparison <- between_periods_comparison[, .(donor_id, donor_name,
recipient_id, recipient_name,
year,
outcome = commitment,
treatment)
# create new variable `period` where treatment year = 0
][, period := year - year[treatment==1], by = .(donor_id, recipient_id)]
# add recipient income group variable
facet_recip <- left_join(between_periods_comparison,
data_crs |> distinct(recipient_id, incomegroup_name),
by = "recipient_id") |>
relocate(incomegroup_name, .after = recipient_name)
data <- facet_recip |>
fmutate(
group = paste(donor_id, recipient_id, sep = "_"),
period = factor(period),
outcome = outcome
) |>
filter(period %in% c(-3:3)) |>
filter(!length(group) < 7, .by = group)
## Level trend
dat_summary <- Rmisc::summarySEwithin(data,
measurevar = "outcome",
withinvars = c("incomegroup_name", "period"),
idvar = "group",
na.rm = TRUE)
ggplot(dat_summary, aes(x = period, y = outcome)) +
geom_point(color = "black") +
geom_errorbar(aes(y = outcome, ymin = outcome - ci, ymax = outcome + ci),
color = "black", width = 0.05) +
facet_wrap(~bi_multi) +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=40, alpha=.1, fill="blue") +
facet_wrap(~incomegroup_name) +
theme_minimal() +
labs(title="Total commitments\nBy donor type",
subtitle="Level: donor-recipient dyad",
y="Millions, USD",
caption="Note: method from Morey (2008) is used for within-subjects comparison. Conf. int. = .95")
between_periods_comparison <- copy(data_dyad)
between_periods_comparison <- between_periods_comparison[, .(donor_id, donor_name,
recipient_id, recipient_name,
year,
outcome = commitment,
treatment)
# create new variable `period` where treatment year = 0
][, period := year - year[treatment==1], by = .(donor_id, recipient_id)]
# add recipient income group variable
facet_recip <- left_join(between_periods_comparison,
data_crs |> distinct(recipient_id, incomegroup_name),
by = "recipient_id") |>
relocate(incomegroup_name, .after = recipient_name)
data <- facet_recip |>
fmutate(
group = paste(donor_id, recipient_id, sep = "_"),
period = factor(period),
outcome = outcome
) |>
filter(period %in% c(-3:3)) |>
filter(!length(group) < 7, .by = group)
## Level trend
dat_summary <- Rmisc::summarySEwithin(data,
measurevar = "outcome",
withinvars = c("incomegroup_name", "period"),
idvar = "group",
na.rm = TRUE)
dat_summary
data_dyad |>
filter(commitment < 0)
# select vars
between_periods_comparison <- copy(data_dyad)
between_periods_comparison <- between_periods_comparison[, .(donor_id, donor_name,
recipient_id, recipient_name,
year,
outcome = commitment,
treatment)
# create new variable `period` where treatment year = 0
][, period := year - year[treatment==1], by = .(donor_id, recipient_id)]
# add recipient income group variable
facet_recip <- left_join(between_periods_comparison,
data_crs |> distinct(recipient_id, incomegroup_name),
by = "recipient_id") |>
relocate(incomegroup_name, .after = recipient_name)
data <- facet_recip |>
fmutate(
group = paste(donor_id, recipient_id, sep = "_"),
period = factor(period),
outcome = outcome
) |>
filter(period %in% c(-3:3)) |>
filter(!length(group) < 7, .by = group)
## Level trend
dat_summary <- Rmisc::summarySEwithin(data,
measurevar = "outcome",
withinvars = c("incomegroup_name", "period"),
idvar = "group",
na.rm = TRUE)
dat_summary
data |>
filter(outcome < 0)
data |>
filter(outcome < 0)
data |>
arrange(outcome)
dat_summary
?summarySEwithin
data <- facet_recip |>
fmutate(
group = paste(donor_id, recipient_id, sep = "_"),
period = factor(period),
outcome = outcome
) |>
filter(period %in% c(-3:3)) |>
filter(!length(group) < 7, .by = group)
## Level trend
dat_summary <- Rmisc::summarySEwithin(data,
measurevar = "outcome",
withinvars = c("incomegroup_name", "period"),
idvar = "group",
na.rm = TRUE)
dat_summary
## Level trend
dat_summary <- Rmisc::summarySEwithin(data,
measurevar = "outcome",
withinvars = c("period", "incomegroup_name"),
idvar = "group",
na.rm = TRUE)
dat_summary
summarySEwithin_and_plot("commitment") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=5, alpha=.1, fill="blue") +
labs(title="Total commitments",
subtitle="Level: donor-recipient dyad",
y="Millions, USD",
caption="Note: method from Morey (2008) is used for within-subjects comparison (Rmisc::summarySEwithin_and_plot). Conf. int. = .95")
summarySEwithin_and_plot("commitment") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=25, alpha=.1, fill="blue") +
labs(title="Total commitments",
subtitle="Level: donor-recipient dyad",
y="Millions, USD",
caption="Note: method from Morey (2008) is used for within-subjects comparison (Rmisc::summarySEwithin_and_plot). Conf. int. = .95")
summarySEwithin_and_plot("commitment") +
annotate("rect", xmin="-1", xmax="1", ymin=0, ymax=25, alpha=.1, fill="blue") +
labs(title="Total commitments",
subtitle="Level: donor-recipient dyad",
y="Millions, USD",
caption="Note: method from Morey (2008) is used for within-subjects comparison (Rmisc::summarySEwithin_and_plot). Conf. int. = .95")
data_emdat |>
filter(country=="Yemen")
data_emdat |>
filter(country %in% c("Yemen", "Venezuela"))
View(data_emdat)
dat_summary
# select vars
between_periods_comparison <- copy(data_dyad)
between_periods_comparison <- between_periods_comparison[, .(donor_id, donor_name,
recipient_id, recipient_name,
year,
outcome = commitment,
treatment)
# create new variable `period` where treatment year = 0
][, period := year - year[treatment==1], by = .(donor_id, recipient_id)]
data <- between_periods_comparison |>
fmutate(
group = paste(donor_id, recipient_id, sep = "_"),
period = factor(period),
outcome = outcome
) |>
filter(period %in% c(-3:3)) |>
filter(!length(group) < 7, .by = group)
## Level trend
dat_summary <- summarize(data,
outcome = median(outcome, na.rm = T),
sd = sd(outcome, na.rm = T),
.by(period))
## Level trend
dat_summary <- summarize(data,
outcome = median(outcome, na.rm = T),
sd = sd(outcome, na.rm = T),
.by = period)
ggplot(dat_summary, aes(x = period, y = outcome)) +
geom_point(color = "black") +
geom_errorbar(aes(y = outcome, ymin = outcome - sd, ymax = outcome + sd),
color = "black", width = 0.05) +
theme_minimal()
dat_summary
data
ggplot(dat_summary, aes(x = period, y = outcome)) +
geom_point(color = "black") +
geom_errorbar(aes(y = outcome, ymin = outcome - sd, ymax = outcome + sd),
color = "black", width = 0.05) +
theme_minimal()
