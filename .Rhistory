ylab("Commitment, MUSD") +
theme_light()
finance |>
pivot_wider(id_cols = -commitment_mean,
names_from = appeal, values_from = disbursement_mean) |>
arrange(desc(Yes)) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkblue", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Commitment, MUSD") +
theme_light()
finance |>
pivot_wider(id_cols = -commitment_mean,
names_from = appeal, values_from = disbursement_mean) |>
arrange(desc(Yes)) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Commitment, MUSD") +
theme_light()
finance |>
pivot_wider(id_cols = -commitment_mean,
names_from = appeal, values_from = disbursement_mean) |>
arrange(desc(Yes)) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Disbursement, MUSD") +
theme_light()
finance |>
pivot_wider(id_cols = -commitment_mean,
names_from = appeal, values_from = disbursement_mean) |>
arrange(desc(Yes)) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Yearly disbursement (avg), MUSD") +
theme_light()
finance |>
pivot_wider(id_cols = -commitment_mean,
names_from = appeal, values_from = disbursement_mean) |>
arrange(desc(Yes)) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Avg yearly disbursement, MUSD") +
theme_light()
finance |>
pivot_wider(id_cols = -commitment_mean,
names_from = appeal, values_from = disbursement_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Avg. yearly disbursement, MUSD") +
theme_light()
ggplot(finance,
aes(x=appeal, y=disbursement_mean)) +
geom_boxplot()
?geom_boxplot
ggplot(finance,
aes(x=appeal, y=disbursement_mean)) +
geom_boxplot(fill = c("darkgrey", "orange")) +
theme_light()
ggplot(finance,
aes(x=appeal, y=disbursement_mean)) +
geom_boxplot(fill = c("darkgrey", "orange")) +
theme_light() +
labs(y="Avg. yearly disbursement, MUSD")
finance |>
wilcox_effsize(disbursement_mean ~ appeal, paired = TRUE)
finance |>
rstatix::wilcox_effsize(disbursement_mean ~ appeal, paired = TRUE)
install.packages('coin')
finance |>
rstatix::wilcox_effsize(disbursement_mean ~ appeal, paired = TRUE)
finance |>
rename(`Commitment, MUSD (avg)` = commitment_mean,
`Disbursements, MUSD (avg)` = disbursement_mean) |>
tbl_summary(
by=appeal,
include = -recipient_name,
type = list(
`Commitment, MUSD (avg)` ~ "continuous",
`Disbursements, MUSD (avg)` ~ "continuous")
) |>
add_p(test = list(
all_continuous() ~ "paired.wilcox.test"),
group = recipient_name)
finance |>
rstatix::wilcox_effsize(disbursement_mean ~ appeal, paired = TRUE)
finance |>
rstatix::wilcox_effsize(list(disbursement_mean ~ appeal,
commitment_mean ~appeal),
paired = TRUE)
?wilcox_effsize
finance |>
rstatix::wilcox_effsize(commitment_mean ~appeal,
paired = TRUE)
finance |>
rstatix::wilcox_effsize(disbursement_mean ~ appeal,
paired = TRUE)
finance  %>%
wilcox_test(disbursement_mean ~ appeal, paired = TRUE) |>
add_significance()
finance  %>%
wilcox_test(commitment_mean ~ appeal, paired = TRUE) |>
add_significance()
assignment |>
filter(!is.na(disbursement)) |>
filter(sum(appeal_n, na.rm = T) != 0, .by = c(recipient_code, recipient_name)) |>
rename(appeal = appeal_n) |>
mutate(appeal = if_else(appeal != 0, "Yes", "No")) |>
summarize(
channel_nonstate_mean = mean(channel_nonstate, na.rm = T),
channel_nonstate_ngo_mean = mean(channel_nonstate_ngo, na.rm = T),
channel_nonstate_other_mean = mean(channel_nonstate_other, na.rm = T),
.by = c(recipient_name, appeal)
)
channel <- assignment |>
filter(!is.na(disbursement)) |>
filter(sum(appeal_n, na.rm = T) != 0, .by = c(recipient_code, recipient_name)) |>
rename(appeal = appeal_n) |>
mutate(appeal = if_else(appeal != 0, "Yes", "No")) |>
summarize(
channel_nonstate_mean = mean(channel_nonstate, na.rm = T),
channel_nonstate_ngo_mean = mean(channel_nonstate_ngo, na.rm = T),
channel_nonstate_other_mean = mean(channel_nonstate_other, na.rm = T),
.by = c(recipient_name, appeal)
)
channel <- assignment |>
filter(!is.na(disbursement)) |>
filter(sum(appeal_n, na.rm = T) != 0, .by = c(recipient_code, recipient_name)) |>
rename(appeal = appeal_n) |>
mutate(appeal = if_else(appeal != 0, "Yes", "No")) |>
summarize(
channel_nonstate_mean = mean(channel_nonstate, na.rm = T),
channel_nonstate_ngo_mean = mean(channel_nonstate_ngo, na.rm = T),
channel_nonstate_other_mean = mean(channel_nonstate_other, na.rm = T),
.by = c(recipient_name, appeal)
)
channel <- assignment |>
filter(!is.na(disbursement)) |>
filter(sum(appeal_n, na.rm = T) != 0, .by = c(recipient_code, recipient_name)) |>
rename(appeal = appeal_n) |>
mutate(appeal = if_else(appeal != 0, "Yes", "No")) |>
summarize(
channel_nonstate_mean = mean(channel_nonstate, na.rm = T),
channel_nonstate_ngo_mean = mean(channel_nonstate_ngo, na.rm = T),
channel_nonstate_other_mean = mean(channel_nonstate_other, na.rm = T),
.by = c(recipient_name, appeal)
)
channel |>
pivot_wider(id_cols = c(appeal, channel_nonstate_mean),
names_from = appeal, values_from = channel_nonstate_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No))
?pivot_wider
channel
channel |>
pivot_wider(id_cols = recipient_name,
names_from = appeal, values_from = channel_nonstate_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No))
channel |>
pivot_wider(id_cols = recipient_name,
names_from = appeal, values_from = channel_nonstate_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Avg. yearly disbursement, MUSD") +
theme_light()
channel |>
pivot_wider(id_cols = recipient_name,
names_from = appeal, values_from = channel_nonstate_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Avg. share of nonState bypass") +
theme_light()
# nonState NGO
channel |>
pivot_wider(id_cols = recipient_name,
names_from = appeal, values_from = channel_nonstate_ngo_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Avg. share of nonState NGO bypass") +
theme_light()
# nonState Other
channel |>
pivot_wider(id_cols = recipient_name,
names_from = appeal, values_from = channel_nonstate_other_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Avg. share of nonState Other bypass") +
theme_light()
# nonState Other
channel |>
pivot_wider(id_cols = recipient_name,
names_from = appeal, values_from = channel_nonstate_other_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Avg. share of nonState nonNGO bypass") +
theme_light()
# nonState
channel |>
pivot_wider(id_cols = recipient_name,
names_from = appeal, values_from = channel_nonstate_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Avg. share of nonState bypass") +
theme_light()
# nonState NGO
channel |>
pivot_wider(id_cols = recipient_name,
names_from = appeal, values_from = channel_nonstate_ngo_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Avg. share of nonState NGO bypass") +
theme_light()
# nonState Other
channel |>
pivot_wider(id_cols = recipient_name,
names_from = appeal, values_from = channel_nonstate_other_mean) |>
mutate(recipient_name = fct_reorder(recipient_name, No)) |>
ggplot() +
geom_segment(aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes),
color="grey40") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Avg. share of nonState nonNGO bypass") +
theme_light()
channel
channel |>
pivot_longer(cols = starts_with("channel"), names_to = "name", values_to = "value")
channel |>
pivot_longer(cols = starts_with("channel"),
names_to = "channel", values_to = "share") |>
ggplot(aes(x=appeal, y=share, group=channel)) +
geom_boxplot()
channel |>
pivot_longer(cols = starts_with("channel"),
names_to = "channel", values_to = "share") |>
ggplot(aes(x=appeal, y=share, fill=channel)) +
geom_boxplot()
channel |>
pivot_longer(cols = starts_with("channel"),
names_to = "channel", values_to = "share") |>
ggplot(aes(x=appeal, y=share, fill=channel)) +
geom_boxplot() +
theme_light()
channel |>
pivot_longer(cols = starts_with("channel"),
names_to = "channel", values_to = "share") |>
ggplot(aes(x=appeal, y=share, fill=channel)) +
geom_boxplot() +
theme_light() +
labs(x="Disaster year leading to intern. assistance appeal",
y="Avg. share of nonState nonNGO bypass")
channel |>
tbl_summary(
by=appeal,
include = -recipient_name,
type = list(
channel_nonstate_mean ~ "continuous",
channel_nonstate_ngo_mean ~ "continuous",
channel_nonstate_other_mean ~ "continuous")
) |>
add_p(test = list(
all_continuous() ~ "paired.wilcox.test"),
group = recipient_name)
# compare two groups (non-parametric test)
channel  %>%
wilcox_test(channel_nonstate_mean ~ appeal, paired = TRUE) |>
add_significance()
# compare two groups (non-parametric test)
channel  %>%
wilcox_test(channel_nonstate_mean ~ appeal, paired = TRUE) |>
add_significance()
channel  %>%
wilcox_test(channel_nonstate_ngo_mean ~ appeal, paired = TRUE) |>
add_significance()
channel  %>%
wilcox_test(channel_nonstate_other_mean ~ appeal, paired = TRUE) |>
add_significance()
# effect size
channel |>
rstatix::wilcox_effsize(channel_nonstate_mean ~ appeal,
paired = TRUE)
finance |>
rstatix::wilcox_effsize(channel_nonstate_ngo_mean ~appeal,
paired = TRUE)
finance |>
rstatix::wilcox_effsize(channel_nonstate_ngo_mean ~ appeal,
paired = TRUE)
channel  %>%
wilcox_test(channel_nonstate_ngo_mean ~ appeal, paired = TRUE) |>
add_significance()
finance
channel |>
rstatix::wilcox_effsize(channel_nonstate_ngo_mean ~ appeal,
paired = TRUE)
channel |>
rstatix::wilcox_effsize(channel_nonstate_other_mean ~ appeal,
paired = TRUE)
# Compare two groups
channel |>
tbl_summary(
by=appeal,
include = -recipient_name,
type = list(
channel_nonstate_mean ~ "continuous",
channel_nonstate_ngo_mean ~ "continuous",
channel_nonstate_other_mean ~ "continuous")
) |>
add_p(test = list(
all_continuous() ~ "paired.wilcox.test"),
group = recipient_name)
# compare two groups (non-parametric test)
channel  %>%
wilcox_test(channel_nonstate_mean ~ appeal, paired = TRUE) |>
add_significance()
channel  %>%
wilcox_test(channel_nonstate_ngo_mean ~ appeal, paired = TRUE) |>
add_significance()
channel  %>%
wilcox_test(channel_nonstate_other_mean ~ appeal, paired = TRUE) |>
add_significance()
# effect size
channel |>
rstatix::wilcox_effsize(channel_nonstate_mean ~ appeal,
paired = TRUE)
channel |>
rstatix::wilcox_effsize(channel_nonstate_ngo_mean ~ appeal,
paired = TRUE)
channel |>
rstatix::wilcox_effsize(channel_nonstate_other_mean ~ appeal,
paired = TRUE)
## Number of donors
assignment |>
filter(!is.na(disbursement)) |>
filter(sum(appeal_n, na.rm = T) != 0, .by = c(recipient_code, recipient_name)) |>
rename(appeal = appeal_n) |>
mutate(appeal = if_else(appeal != 0, "Yes", "No")) |>
mutate(n_donor = n_distinct(donor_code), .by = c(recipient_code, recipient_name, year)) |>
summarize(
#    n_donor_mean = mean(n_donor, na.rm = T),
n_donor_median = median(n_donor, na.rm = T),
.by = c(recipient_name, appeal)
) |>
pivot_wider(names_from = appeal, values_from = n_donor_median) |>
arrange(desc(Yes)) |>
mutate(recipient_name = fct_reorder(as.factor(recipient_name), Yes)) |>
ggplot() +
geom_segment( aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes), color="grey") +
geom_point( aes(x=recipient_name, y=No), color="green", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Number of donors") +
theme_light()
## Number of donors
assignment |>
filter(!is.na(disbursement)) |>
filter(sum(appeal_n, na.rm = T) != 0, .by = c(recipient_code, recipient_name)) |>
rename(appeal = appeal_n) |>
mutate(appeal = if_else(appeal != 0, "Yes", "No")) |>
mutate(n_donor = n_distinct(donor_code), .by = c(recipient_code, recipient_name, year)) |>
summarize(
#    n_donor_mean = mean(n_donor, na.rm = T),
n_donor_median = median(n_donor, na.rm = T),
.by = c(recipient_name, appeal)
) |>
pivot_wider(names_from = appeal, values_from = n_donor_median) |>
arrange(desc(Yes)) |>
mutate(recipient_name = fct_reorder(as.factor(recipient_name), Yes)) |>
ggplot() +
geom_segment( aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes), color="grey") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Number of donors") +
theme_light()
## Number of donors
assignment |>
filter(!is.na(disbursement)) |>
filter(sum(appeal_n, na.rm = T) != 0, .by = c(recipient_code, recipient_name)) |>
rename(appeal = appeal_n) |>
mutate(appeal = if_else(appeal != 0, "Yes", "No")) |>
mutate(n_donor = n_distinct(donor_code), .by = c(recipient_code, recipient_name, year)) |>
summarize(
#    n_donor_mean = mean(n_donor, na.rm = T),
n_donor_median = median(n_donor, na.rm = T),
.by = c(recipient_name, appeal)
) |>
pivot_wider(names_from = appeal, values_from = n_donor_median) |>
arrange(desc(Yes)) |>
mutate(recipient_name = fct_reorder(as.factor(recipient_name), No)) |>
ggplot() +
geom_segment( aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes), color="grey") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Number of donors") +
theme_light()
donor <- assignment |>
filter(!is.na(disbursement)) |>
filter(sum(appeal_n, na.rm = T) != 0, .by = c(recipient_code, recipient_name)) |>
rename(appeal = appeal_n) |>
mutate(appeal = if_else(appeal != 0, "Yes", "No")) |>
mutate(n_donor = n_distinct(donor_code), .by = c(recipient_code, recipient_name, year)) |>
summarize(
#    n_donor_mean = mean(n_donor, na.rm = T),
n_donor_median = median(n_donor, na.rm = T),
.by = c(recipient_name, appeal)
)
donor <- assignment |>
filter(!is.na(disbursement)) |>
filter(sum(appeal_n, na.rm = T) != 0, .by = c(recipient_code, recipient_name)) |>
rename(appeal = appeal_n) |>
mutate(appeal = if_else(appeal != 0, "Yes", "No")) |>
mutate(n_donor = n_distinct(donor_code), .by = c(recipient_code, recipient_name, year)) |>
summarize(
n_donor_mean = mean(n_donor, na.rm = T),
n_donor_median = median(n_donor, na.rm = T),
.by = c(recipient_name, appeal)
)
donor
donor |>
pivot_wider(id_cols = recipient_name,
names_from = appeal, values_from = n_donor_median) |>
arrange(desc(Yes)) |>
mutate(recipient_name = fct_reorder(as.factor(recipient_name), No)) |>
ggplot() +
geom_segment( aes(x=recipient_name, xend=recipient_name, y=No, yend=Yes), color="grey") +
geom_point( aes(x=recipient_name, y=No), color="darkgrey", size=3 ) +
geom_point( aes(x=recipient_name, y=Yes), color="orange", size=3 ) +
coord_flip()+
xlab("") +
ylab("Number of donors") +
theme_light()
